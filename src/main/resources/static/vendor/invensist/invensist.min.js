var Form = Class.extend(function(){
	this.constructor = function($form){
		this.form = $form;
	};

	this.refresh = function() {
		var f = this;
		this.form.validator('destroy').validator().on('submit', function (e) {
			if (e.isDefaultPrevented()) {
				console.log("Invalid Form");
			} else {
				var valid = typeof f._customValidationHandler === 'undefined' || f._customValidationHandler(f.data());
				if (valid) {
					if (typeof f._submitHandler !== 'undefined') {
						f._submitHandler(f.data());
					}
				} else {
					e.preventDefault();
				}
			}
		});
	};

	this.onSubmit = function(submitHandler) {
		this._submitHandler = submitHandler;
	};
	
	this.customValidationHandler = function(handler) {
		this._customValidationHandler = handler;
	};

	this.data = function() {
		var formArray = this.form.serializeArray();
		var result = {};
		for (var i = 0; i < formArray.length; i++){
			result[formArray[i]['name']] = formArray[i]['value'];
		}
		return result;		
	};
});

